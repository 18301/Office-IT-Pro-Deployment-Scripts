Add-Type  -ErrorAction SilentlyContinue -TypeDefinition @"
   public enum OfficeCTRVersion
   {
      Office2013,
      Office2016
   }
"@function Download-OfficeUpdatesSCCM2007{Param    (        [Parameter(Mandatory=$False)]	    [OfficeCTRVersion]$ProductVersion = 'Office2016',	    [Parameter()]	    [String]$Path = $NULL,	    [Parameter()]	    [String]$Version = $NULL,	    [Parameter()]	    [String]$Bitness = 'All'    )Process { $scriptPath = "." if ($PSScriptRoot) {   $scriptPath = $PSScriptRoot } else {   $scriptPath = (Get-Item -Path ".\").FullName }    #Importing all required functions    Import-Module $scriptPath\SCCM2007.psm1    . $scriptPath\Setup-SCCMOfficeUpdates.ps1    Download-OfficeUpdates -ProductVersion $ProductVersion -Path $Path -Version $Version -Bitness $Bitness}}function Setup-SCCM2007UpdatePackage{Param(    #[Parameter(Mandatory=$true, HelpMessage="SCCM Server")][Alias("Server","SmsServer")][System.Object] $SccmServer,    [Parameter(Mandatory=$false, HelpMessage="Package Name", ValueFromPipeline=$true)][String] $Name = "Office Updates",     [Parameter(Mandatory=$false, HelpMessage="Package Version")][String] $Version = "",    [Parameter(Mandatory=$false, HelpMessage="Package Manufacturer")][String] $Manufacturer = "",    [Parameter(Mandatory=$false, HelpMessage="Package Language")][String] $Language = "",    [Parameter(Mandatory=$false, HelpMessage="Package Description")][String] $Description = "",    [Parameter(Mandatory=$false, HelpMessage="Package Data Source Path")][String] $PkgSourcePath = "\\$($env:computername)\OfficeUpdates",    [Parameter(Mandatory=$false, HelpMessage="Package Sharename")][String] $PkgShareName = "",    [Parameter(Mandatory=$false, HelpMessage="Program Name")][String] $PrgName = "ProPlus Updates",    #[Parameter(Mandatory=$true, HelpMessage="Program PackageID")]$PrgPackageID,    [Parameter(Mandatory=$false, HelpMessage="Program Comment")][String] $PrgComment = "",    [Parameter(Mandatory=$false, HelpMessage="Program CommandLine")][String] $PrgCommandLine = "SCO365PPTrigger.exe -EnableLogging true -C2RArgs `"updatepromptuser=false forceappshutdown=false displaylevel=false`"",    [Parameter(Mandatory=$false, HelpMessage="Program MaxRunTime")]$PrgMaxRunTime,    [Parameter(Mandatory=$false, HelpMessage="Program Diskspace Requirement")]$PrgSpaceReq,    [Parameter(Mandatory=$false, HelpMessage="Program Working Directory")][String] $PrgWorkDir = "",    [Parameter(Mandatory=$false, HelpMessage="Program Flags")] $PrgFlags,    #[Parameter(Mandatory=$true, HelpMessage="SCCM Server")][Alias("Server","SmsServer")][System.Object] $SccmServer,    #[Parameter(Mandatory=$true, HelpMessage="PackageID")][String] $DPPackageID,    #[Parameter(Mandatory=$false, HelpMessage="DistributionPoint Servername")][String]$DPName = "",    #[Parameter(Mandatory=$false, HelpMessage="All DistributionPoints of SiteCode")][String] $DPsSiteCode = "",    [Parameter(Mandatory=$false, HelpMessage="Distribution Point Group")][String] $DPGroupName = "",    [Parameter(Mandatory=$false, HelpMessage="YYYYMMDDhhmm")] $DeadLine,    [Switch] $AllDPs)             $scriptPath = "."         if ($PSScriptRoot) {           $scriptPath = $PSScriptRoot         } else {           $scriptPath = (Get-Item -Path ".\").FullName         }         #Importing all required functions    Import-Module $scriptPath\SCCM2007.psm1        $sccmServer = Connect-SCCMServer    $sccmPackage = New-SCCMPackage -SccmServer $sccmServer -Name $Name -Version $Version -Manufacturer $Manufacturer -Language $Language -Description $Description -PkgSourcePath $PkgSourcePath -PkgShareName $PkgShareName    New-SCCMProgram -SccmServer $sccmServer -PrgName $PrgName -PrgPackageID $sccmPackage.PackageID -PrgComment $PrgComment -PrgCommandLine $PrgCommandLine -PrgMaxRunTime $PrgMaxRunTime -PrgSpaceReq $PrgSpaceReq -PrgWorkDir $PrgWorkDir -PrgFlags $PrgFlags    Add-SCCMDistributionPoint -SccmServer $sccmServer -DPPackageID $sccmPackage.PackageID -DPName $sccmServer.Machine -DPsSiteCode $sccmServer.SccmProvider.SiteCode -DPGroupName $DPGroupName    New-SCCMAdvertisement -SccmServer $sccmServer -AdvertisementName "Office ProPlus Advertisement" -collectionID SMS00001 -PackageID $sccmPackage.PackageID -ProgramName $PrgName -MandatoryTime $DeadLine}